language: c

os:
 - linux
 - osx

sudo: true

before_install:
 - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew update ; fi
 - if [[ "$TRAVIS_OS_NAME" == "osx" ]]; then brew install gcc mlton autoconf make ; fi
 - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then sudo apt-get -qq update ; fi
 - if [[ "$TRAVIS_OS_NAME" == "linux" ]]; then sudo apt-get install -y gcc gcc-multilib mlton autoconf make ; fi
 
install:
 - ./autobuild
 - ./configure
 - travis_wait 30 make mlkit
 - make mlkit_libs
 - sudo make install

script:
 - cd test && make test_mlkit